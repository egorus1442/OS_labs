# Лабораторная работа №4 по операционным системам
---

## Сборка:
```
make
```

## Запуск:
```
./test_dinamic
./test_static
```
---

## О лабе:


### Реализация динамических библиотек

Были созданы две динамические библиотеки:

libprime.so — содержит функции для подсчёта простых чисел на отрезке [A, B].
libpi.so — содержит функции для вычисления числа Пи.
Функции в библиотеках:

PrimeCountNaive — наивный алгоритм подсчёта простых чисел.
PrimeCountEratosthenes — алгоритм "Решето Эратосфена".
PiLeibniz — вычисление числа Пи с использованием ряда Лейбница.
PiWallis — вычисление числа Пи с использованием формулы Валлиса.

### Тестовая программа №1 (статическая линковка)

Программа №1 использует библиотеки на этапе компиляции. Это означает, что код библиотек включается в исполняемый файл, и программа не зависит от внешних библиотек во время выполнения.

Особенности:

Реализация функций фиксирована (используются PrimeCountNaive и PiLeibniz).
Невозможно переключить реализацию во время выполнения.
Программа выводит информацию о том, какая реализация была использована.
Пример работы:

```
Copy
Input program code:
 1 -> PrimeCount
 2 -> Pi
-1 -> Exit
1
Enter A and B: 1 10
PrimeCount(1, 10) = 4
Implementation used: Naive
```

### Тестовая программа №2 (динамическая загрузка)

Программа №2 загружает библиотеки во время выполнения с использованием функций dlopen, dlsym и dlclose. Это позволяет:

Переключать реализации функций во время выполнения.
Загружать библиотеки по относительным путям.
Особенности:

Реализация функций может быть изменена при вводе команды 0.
Программа выводит информацию о текущей реализации.
Пример работы:

```
Copy
Input program code:
 0 -> Library switch
 1 -> PrimeCount
 2 -> Pi
-1 -> Exit
0
Library switched successfully!
Current PrimeCount implementation: Eratosthenes
Current Pi implementation: Wallis

Input program code:
 0 -> Library switch
 1 -> PrimeCount
 2 -> Pi
-1 -> Exit
1
Enter A and B: 1 10
PrimeCount(1, 10) = 4
Implementation used: Eratosthenes
```

### Переключение реализаций

В программе №2 реализована возможность переключения между реализациями функций:

Для PrimeCount переключаются Naive и Eratosthenes.
Для Pi переключаются Leibniz и Wallis.
Переключение происходит при вводе команды 0. Программа выводит сообщение о текущей реализации.

### Пользовательский ввод

Пользовательский ввод организован следующим образом:

0 — переключение реализаций (только для программы №2).
1 arg1 arg2 — вызов функции PrimeCount с аргументами arg1 и arg2.
2 arg1 — вызов функции Pi с аргументом arg1.
-1 — завершение программы.

### Анализ работы
### Сравнение статической и динамической линковки

Статическая линковка:
Преимущества: Простота, высокая производительность.
Недостатки: Невозможность переключения реализаций, увеличенный размер исполняемого файла.
Динамическая линковка:
Преимущества: Гибкость, возможность переключения реализаций, экономия памяти.
Недостатки: Зависимость от окружения, накладные расходы на загрузку библиотек.
3
### Выводы

Программа №1 демонстрирует использование статической линковки. Она проста в использовании, но не поддерживает переключение реализаций.
Программа №2 демонстрирует использование динамической линковки. Она более гибкая, но требует дополнительных усилий для загрузки и управления библиотеками.

### Заключение

В ходе выполнения лабораторной работы были изучены и применены на практике следующие концепции:

Создание и использование динамических библиотек.
Статическая и динамическая линковка.
Переключение реализаций функций во время выполнения.
Работа демонстрирует преимущества и недостатки каждого подхода, а также предоставляет готовые решения для использования динамических библиотек в реальных проектах.

## Краткая теория:

### Динамические библиотеки

Динамические библиотеки — это скомпилированные фрагменты кода, которые могут быть загружены в память и использованы программой во время её выполнения. Они позволяют:

Разделять код между несколькими программами.
Уменьшать размер исполняемых файлов.
Упрощать обновления, так как библиотеки могут быть заменены без перекомпиляции основной программы.
Преимущества динамических библиотек:

Гибкость: Библиотеки могут быть загружены и выгружены во время выполнения.
Экономия памяти: Одна библиотека может использоваться несколькими программами одновременно.
Упрощение обновлений: Достаточно обновить библиотеку, не перекомпилируя основную программу.
Недостатки динамических библиотек:

Зависимость от окружения: Программа может не запуститься, если библиотека отсутствует или несовместима.
Накладные расходы: Динамическая загрузка требует дополнительных ресурсов.


### Статическая и динамическая линковка

Статическая линковка: Код библиотеки включается в исполняемый файл на этапе компиляции. Программа становится самодостаточной, но её размер увеличивается.

Динамическая линковка: Библиотеки загружаются в память во время выполнения программы. Это позволяет переключать реализации и экономить память.