# Лабораторная работа №3 по операционным системам

Программа использует разделяемую память (shared memory) для взаимодействия между родительским и дочерними процессами. Она состоит из трех частей: родительский процесс (parent.c) и два дочерних процесса (child1.c и child2.c). Каждый процесс выполняет свою задачу, а данные передаются через общую область памяти, созданную с помощью mmap.

---

### Сборка:
```
gcc parent.c -o parent
gcc child1.c -o child1
gcc child2.c -o child2
```

### Запуск:
```
./parent
```
---

## Краткая теория:

### Файловые системы

#### Требования к долговременному хранилищу информации
1. Хранение большого количества информации
2. Должна храниться после завершения работы процесса
3. Параллельный доступ при чтении

#### Вопросы при хранении
1. Поиск информации

Индексация: Ускоряет поиск за счет использования индексов.
Метаданные: Хранят информацию о файлах для быстрого поиска.
Кэширование: Ускоряет доступ к часто используемым данным.
Фрагментация: Может замедлить поиск, если данные разбросаны по диску.

2. Безопасность

Контроль доступа: Определяет, кто может читать, писать или выполнять файлы.
Шифрование: Защищает данные от несанкционированного доступа.
Журналирование: Помогает восстановить данные после сбоев.
Антивирусное ПО: Защищает от вредоносных программ.

3. Поиск свободного места

Файловая система: Управляет свободным пространством и распределяет его между файлами.
Дефрагментация: Объединяет свободные блоки для более эффективного использования.
Квоты: Ограничивают использование дискового пространства для пользователей или групп.
Мониторинг: Инструменты для отслеживания использования дискового пространства.

#### Логический информационный блок, создаваемый процессом
Файл: Это логический блок данных, создаваемый и управляемый операционной системой. Процессы (программы) создают, читают, записывают и удаляют файлы.


#### Долговременный характер
Хранение: Файлы предназначены для долговременного хранения данных. Они сохраняются на диске и доступны даже после перезагрузки системы.

#### Структура, имя, доступ, безопасность, максимальный размер
- Структура: Файлы могут иметь различные структуры, такие как текстовые, бинарные, базы данных и т.д.

- Имя: Каждый файл имеет уникальное имя в пределах своего каталога, что позволяет легко его идентифицировать.

- Доступ: Права доступа определяют, кто может читать, записывать или выполнять файл.

- Безопасность: Файлы могут быть защищены с помощью шифрования и других методов для предотвращения несанкционированного доступа.

- Максимальный размер: Зависит от файловой системы. Например, FAT32 поддерживает файлы до 4 ГБ, в то время как NTFS и ext4 поддерживают файлы значительно большего размера.


### Имена файлов
1. Регистрозависимость

Регистрозависимость: В некоторых файловых системах (например, ext4 в Linux) имена файлов чувствительны к регистру, то есть "File.txt" и "file.txt" считаются разными файлами. В других системах (например, NTFS в Windows) регистр не учитывается, и эти имена будут считаться одним и тем же файлом.
1. Длина

Длина: Максимальная длина имени файла зависит от файловой системы. Например, в NTFS максимальная длина имени файла составляет 255 символов, а в ext4 — 255 байт.
1. Расширения

Расширения: Расширение файла — это часть имени файла, которая следует после точки (например, ".txt", ".jpg"). Расширения используются для указания типа файла и помогают операционной системе и приложениям определить, как обрабатывать файл.


### Типы файлов
1. Обычные файлы

ASCII: Текстовые файлы, содержащие данные в виде последовательности символов, кодированных в ASCII. Примеры: .txt, .csv.
Двоичные: Файлы, содержащие данные в виде последовательности байтов, которые могут представлять любые типы данных. Примеры: .exe, .jpg, .mp3.

2. Каталоги (директории)

Каталоги: Специальные файлы, которые содержат ссылки на другие файлы и каталоги. Они используются для организации файловой системы и управления доступом к файлам.
3. Символьные специальные файлы

Символьные ссылки: Файлы, которые являются ссылками на другие файлы или каталоги. Они позволяют создавать альтернативные пути к существующим файлам и каталогам. Примеры: символьные ссылки в Unix-подобных системах.

4. Блочные специальные файлы

Блочные устройства: Файлы, которые представляют устройства, такие как жесткие диски, CD-ROM и другие устройства хранения данных. Они позволяют операционной системе взаимодействовать с этими устройствами как с файлами. Примеры: /dev/sda в Unix-подобных системах.

#### Характеристики файлов
1. Доступ
Последовательный, произвольный
2. Атрибуты файлов
a) Защита
b) Пароль
c) Создатель
d) Флаг «скрытый»
e) Флаг «системный»
f) И др.

#### Основные операции с файлами
1. Создать, удалить, переименовать
2. Открыть, закрыть
3. Прочитать, записать, добавить
4. Найти (Seek)
5. Получить атрибуты и установить атрибуты

### Каталоги
1. Одноуровневые и иерархические каталоги

Одноуровневые каталоги: Все файлы находятся в одном каталоге без вложенных подкаталогов. Это простая структура, но она может стать неудобной при большом количестве файлов.
Иерархические каталоги: Каталоги могут содержать подкаталоги, что позволяет создавать сложные структуры для организации файлов. Это более гибкая и удобная структура для управления большими объемами данных.

2. Имена файлов и пути

Абсолютные пути: Полный путь к файлу или каталогу, начиная с корневого каталога. В Unix-подобных системах абсолютный путь начинается с символа "/". Пример: /home/user/documents/file.txt.
Относительные пути: Путь к файлу или каталогу, который зависит от текущего местоположения. Относительный путь не начинается с корневого каталога. Пример: Если текущий каталог /home/user, то относительный путь к файлу может быть documents/file.txt.

### Реализация файлов

1. Непрерывное размещение

Описание: Файл хранится в непрерывной последовательности блоков на диске.

Преимущества: Простота реализации, высокая скорость последовательного доступа.

Недостатки: Трудности с управлением свободного пространства, фрагментация диска.

2. Размещение с использованием связанного списка

Описание: Файл хранится в виде связанного списка блоков, где каждый блок содержит указатель на следующий блок.
Преимущества: Гибкость в использовании дискового пространства, уменьшение фрагментации.

Недостатки: Увеличение накладных расходов на хранение указателей, ухудшение производительности при последовательном доступе.

3. Размещение с помощью списка, использующего таблицу в памяти

Описание: Файл хранится в виде списка блоков, но указатели на блоки хранятся в таблице в памяти (например, FAT — File Allocation Table).

Преимущества: Улучшенная производительность по сравнению со связанным списком, уменьшение фрагментации.
Недостатки: Ограничения на размер файла и объем диска из-за фиксированного размера таблицы.

4. I-узлы (Inodes)

Описание: Файл представлен i-узлом, который содержит метаданные и указатели на блоки данных. I-узлы хранятся в специальной таблице на диске.

Преимущества: Гибкость и эффективность в управлении метаданными и данными, поддержка больших файлов и объемов.
Недостатки: Сложность реализации, необходимость управления i-узлами и их таблицей.

Примеры:
Непрерывное размещение: Используется в простых файловых системах.
Связанный список: Используется в некоторых старых файловых системах.
Таблица в памяти: FAT (File Allocation Table) в DOS и Windows.
I-узлы: Используются в Unix-подобных системах, таких как ext2, ext3, ext4.


### UNIX. Фундаментальные принципы
1. Использование VFS (Virtual File System)

Описание: VFS — это абстрактный слой, который позволяет операционной системе работать с различными файловыми системами через единый интерфейс.
Преимущества: Упрощает управление различными файловыми системами, обеспечивает гибкость и расширяемость.

2. Стандартные каталоги

/bin: Содержит основные команды, необходимые для запуска системы и восстановления.
/dev: Содержит файлы устройств, представляющие оборудование.
/etc: Содержит системные конфигурационные файлы.
/lib: Содержит библиотеки, необходимые для работы команд в /bin и /sbin.
/usr: Содержит пользовательские программы и данные, такие как /usr/bin, /usr/lib и /usr/share.

3. Имена файлов

Описание: Имена файлов в UNIX представляют собой ASCII строки с максимальной длиной 255 символов.
Преимущества: Поддержка длинных имен файлов, что упрощает их идентификацию и управление.

4. Жесткие и символьные ссылки

Жесткие ссылки: Указывают на один и тот же i-узел, что означает, что изменения в одном файле отражаются на всех жестких ссылках.
Символьные ссылки: Указывают на путь к файлу или каталогу. Они могут указывать на файлы на разных файловых системах и не зависят от i-узлов.

5. Exclusive lock и shared lock

Exclusive lock (исключительная блокировка): Блокирует файл для записи, предотвращая доступ других процессов к файлу для записи или чтения.
Shared lock (разделяемая блокировка): Блокирует файл для чтения, позволяя другим процессам читать файл, но не записывать в него.

#### Ext2
Ext2 (Second Extended File System) — это одна из первых файловых систем, разработанных для Linux. Она была создана как улучшение более ранней файловой системы ext и стала стандартом для многих дистрибутивов Linux в 1990-х годах. Вот основные характеристики и особенности ext2:

#### Основные характеристики Ext2:
- I-узлы (Inodes):

Описание: Каждый файл и каталог в ext2 представлен i-узлом, который содержит метаданные, такие как владелец, права доступа, размер файла и указатели на блоки данных.
Преимущества: Эффективное управление метаданными и данными, поддержка больших файлов и объемов.

- Блоки данных:

Описание: Данные файлов хранятся в блоках фиксированного размера (обычно 1 КБ, 2 КБ или 4 КБ).
Преимущества: Упрощает управление дисковым пространством и повышает производительность.

- Суперблок:

Описание: Содержит информацию о файловой системе, такую как размер блока, количество i-узлов и блоков, а также состояние файловой системы.
Преимущества: Обеспечивает централизованное управление файловой системой.

#### Ext3-4
1. Структура совместима с Ext2
2. Используется принцип журналируемой ФС
3. Каждая операция пишется в кольцевой журнал
4. JBD (Journal block device) – блочное устройство журналирования

a) Запись журнала (в рамках блока)
b) Описатель атомарной операции (например, write)
c) Транзакция

#### NTFS
 (New Technology File System) — это современная файловая система, разработанная Microsoft для операционных систем Windows. Одной из ключевых особенностей NTFS является использование Master File Table (MFT), которая играет центральную роль в управлении файлами и данными. Вот основные аспекты MFT:

#### Master File Table (MFT)
Описание:

MFT — это основная структура данных в NTFS, которая хранит информацию о всех файлах и каталогах на диске. Каждый файл и каталог представлен записью в MFT.

Структура записи MFT:

Заголовок: Содержит информацию о типе записи, размере и других метаданных.

Атрибуты: Каждая запись MFT содержит набор атрибутов, которые описывают различные аспекты файла или каталога. 

Основные атрибуты включают:
$STANDARD_INFORMATION: Содержит базовые метаданные, такие как временные метки и права доступа.
$FILE_NAME: Содержит имя файла и родительский каталог.
$DATA: Содержит данные файла.
$INDEX_ROOT и $INDEX_ALLOCATION: Используются для индексации каталогов.

Размер записи MFT:
Размер записи MFT обычно составляет 1 КБ, но может быть изменен при форматировании диска.

Фрагментация MFT:
MFT может фрагментироваться, особенно при длительном использовании или при наличии большого количества файлов. Фрагментация MFT может замедлить доступ к данным.

Резервные копии MFT:
NTFS хранит резервную копию MFT (MFTMirr) для повышения надежности. В случае повреждения основной MFT система может использовать резервную копию для восстановления данных.

#### Преимущества MFT:

Эффективное управление метаданными: MFT обеспечивает централизованное хранение метаданных, что упрощает управление файлами и каталогами.
Поддержка больших файлов и объемов: MFT позволяет NTFS поддерживать большие файлы и объемы данных.
Надежность: Использование резервной копии MFT повышает надежность файловой системы.

#### Недостатки MFT:
Фрагментация: MFT может фрагментироваться, что может замедлить доступ к данным.
Сложность: Структура MFT и управление атрибутами могут быть сложными для понимания и реализации.

